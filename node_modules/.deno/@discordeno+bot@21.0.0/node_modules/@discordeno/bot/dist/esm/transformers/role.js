import { iconHashToBigInt } from '../index.js';
import { Permissions } from './toggles/Permissions.js';
import { RoleToggles } from './toggles/role.js';
export const baseRole = {
    // This allows typescript to still check for type errors on functions below
    ...undefined,
    get tags () {
        return {
            botId: this.internalTags?.botId,
            integrationId: this.internalTags?.integrationId,
            subscriptionListingId: this.internalTags?.subscriptionListingId,
            availableForPurchase: this.toggles?.availableForPurchase,
            guildConnections: this.toggles?.guildConnections,
            premiumSubscriber: this.toggles?.premiumSubscriber
        };
    },
    /** If this role is showed separately in the user listing */ get hoist () {
        return !!this.toggles?.has('hoist');
    },
    /** Whether this role is managed by an integration */ get managed () {
        return !!this.toggles?.has('managed');
    },
    /** Whether this role is mentionable */ get mentionable () {
        return !!this.toggles?.has('mentionable');
    },
    /** Whether this is the guilds premium subscriber role */ get premiumSubscriber () {
        return !!this.toggles?.has('premiumSubscriber');
    },
    /** Whether this role is available for purchase. */ get availableForPurchase () {
        return !!this.toggles?.has('availableForPurchase');
    },
    /** Whether this is a guild's linked role. */ get guildConnections () {
        return !!this.toggles?.has('guildConnections');
    }
};
export function transformRole(bot, payload) {
    const role = Object.create(baseRole);
    const props = bot.transformers.desiredProperties.role;
    if (props.id && payload.role.id) role.id = bot.transformers.snowflake(payload.role.id);
    if (props.name && payload.role.name) role.name = payload.role.name;
    if (props.position) role.position = payload.role.position;
    if (props.guildId && payload.guildId) role.guildId = bot.transformers.snowflake(payload.guildId);
    if (props.color && payload.role.color !== undefined) role.color = payload.role.color;
    if (props.permissions && payload.role.permissions) role.permissions = new Permissions(payload.role.permissions);
    if (props.icon && payload.role.icon) role.icon = iconHashToBigInt(payload.role.icon);
    if (props.unicodeEmoji && payload.role.unicode_emoji) role.unicodeEmoji = payload.role.unicode_emoji;
    if (props.flags) role.flags = payload.role.flags;
    if (props.tags && payload.role.tags) {
        role.internalTags = {};
        if (payload.role.tags.bot_id) role.internalTags.botId = bot.transformers.snowflake(payload.role.tags.bot_id);
        if (payload.role.tags.integration_id) role.internalTags.integrationId = bot.transformers.snowflake(payload.role.tags.integration_id);
        if (payload.role.tags.subscription_listing_id) role.internalTags.subscriptionListingId = bot.transformers.snowflake(payload.role.tags.subscription_listing_id);
    }
    if (props.toggles) {
        role.toggles = new RoleToggles(payload.role);
    }
    return bot.transformers.customizers.role(bot, payload.role, role);
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy90cmFuc2Zvcm1lcnMvcm9sZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IEJpZ1N0cmluZywgRGlzY29yZFJvbGUgfSBmcm9tICdAZGlzY29yZGVuby90eXBlcydcbmltcG9ydCB7IHR5cGUgSW50ZXJuYWxCb3QsIHR5cGUgUm9sZSwgaWNvbkhhc2hUb0JpZ0ludCB9IGZyb20gJy4uL2luZGV4LmpzJ1xuaW1wb3J0IHsgUGVybWlzc2lvbnMgfSBmcm9tICcuL3RvZ2dsZXMvUGVybWlzc2lvbnMuanMnXG5pbXBvcnQgeyBSb2xlVG9nZ2xlcyB9IGZyb20gJy4vdG9nZ2xlcy9yb2xlLmpzJ1xuXG5leHBvcnQgY29uc3QgYmFzZVJvbGU6IEludGVybmFsQm90Wyd0cmFuc2Zvcm1lcnMnXVsnJGluZmVycmVkVHlwZXMnXVsncm9sZSddID0ge1xuICAvLyBUaGlzIGFsbG93cyB0eXBlc2NyaXB0IHRvIHN0aWxsIGNoZWNrIGZvciB0eXBlIGVycm9ycyBvbiBmdW5jdGlvbnMgYmVsb3dcbiAgLi4uKHVuZGVmaW5lZCBhcyB1bmtub3duIGFzIEludGVybmFsQm90Wyd0cmFuc2Zvcm1lcnMnXVsnJGluZmVycmVkVHlwZXMnXVsncm9sZSddKSxcblxuICBnZXQgdGFncygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgYm90SWQ6IHRoaXMuaW50ZXJuYWxUYWdzPy5ib3RJZCxcbiAgICAgIGludGVncmF0aW9uSWQ6IHRoaXMuaW50ZXJuYWxUYWdzPy5pbnRlZ3JhdGlvbklkLFxuICAgICAgc3Vic2NyaXB0aW9uTGlzdGluZ0lkOiB0aGlzLmludGVybmFsVGFncz8uc3Vic2NyaXB0aW9uTGlzdGluZ0lkLFxuICAgICAgYXZhaWxhYmxlRm9yUHVyY2hhc2U6IHRoaXMudG9nZ2xlcz8uYXZhaWxhYmxlRm9yUHVyY2hhc2UsXG4gICAgICBndWlsZENvbm5lY3Rpb25zOiB0aGlzLnRvZ2dsZXM/Lmd1aWxkQ29ubmVjdGlvbnMsXG4gICAgICBwcmVtaXVtU3Vic2NyaWJlcjogdGhpcy50b2dnbGVzPy5wcmVtaXVtU3Vic2NyaWJlcixcbiAgICB9XG4gIH0sXG4gIC8qKiBJZiB0aGlzIHJvbGUgaXMgc2hvd2VkIHNlcGFyYXRlbHkgaW4gdGhlIHVzZXIgbGlzdGluZyAqL1xuICBnZXQgaG9pc3QoKSB7XG4gICAgcmV0dXJuICEhdGhpcy50b2dnbGVzPy5oYXMoJ2hvaXN0JylcbiAgfSxcbiAgLyoqIFdoZXRoZXIgdGhpcyByb2xlIGlzIG1hbmFnZWQgYnkgYW4gaW50ZWdyYXRpb24gKi9cbiAgZ2V0IG1hbmFnZWQoKSB7XG4gICAgcmV0dXJuICEhdGhpcy50b2dnbGVzPy5oYXMoJ21hbmFnZWQnKVxuICB9LFxuICAvKiogV2hldGhlciB0aGlzIHJvbGUgaXMgbWVudGlvbmFibGUgKi9cbiAgZ2V0IG1lbnRpb25hYmxlKCkge1xuICAgIHJldHVybiAhIXRoaXMudG9nZ2xlcz8uaGFzKCdtZW50aW9uYWJsZScpXG4gIH0sXG4gIC8qKiBXaGV0aGVyIHRoaXMgaXMgdGhlIGd1aWxkcyBwcmVtaXVtIHN1YnNjcmliZXIgcm9sZSAqL1xuICBnZXQgcHJlbWl1bVN1YnNjcmliZXIoKSB7XG4gICAgcmV0dXJuICEhdGhpcy50b2dnbGVzPy5oYXMoJ3ByZW1pdW1TdWJzY3JpYmVyJylcbiAgfSxcbiAgLyoqIFdoZXRoZXIgdGhpcyByb2xlIGlzIGF2YWlsYWJsZSBmb3IgcHVyY2hhc2UuICovXG4gIGdldCBhdmFpbGFibGVGb3JQdXJjaGFzZSgpIHtcbiAgICByZXR1cm4gISF0aGlzLnRvZ2dsZXM/LmhhcygnYXZhaWxhYmxlRm9yUHVyY2hhc2UnKVxuICB9LFxuICAvKiogV2hldGhlciB0aGlzIGlzIGEgZ3VpbGQncyBsaW5rZWQgcm9sZS4gKi9cbiAgZ2V0IGd1aWxkQ29ubmVjdGlvbnMoKSB7XG4gICAgcmV0dXJuICEhdGhpcy50b2dnbGVzPy5oYXMoJ2d1aWxkQ29ubmVjdGlvbnMnKVxuICB9LFxufVxuXG5leHBvcnQgZnVuY3Rpb24gdHJhbnNmb3JtUm9sZShib3Q6IEludGVybmFsQm90LCBwYXlsb2FkOiB7IHJvbGU6IERpc2NvcmRSb2xlOyBndWlsZElkOiBCaWdTdHJpbmcgfSk6IHR5cGVvZiBib3QudHJhbnNmb3JtZXJzLiRpbmZlcnJlZFR5cGVzLnJvbGUge1xuICBjb25zdCByb2xlOiBSb2xlID0gT2JqZWN0LmNyZWF0ZShiYXNlUm9sZSlcbiAgY29uc3QgcHJvcHMgPSBib3QudHJhbnNmb3JtZXJzLmRlc2lyZWRQcm9wZXJ0aWVzLnJvbGVcbiAgaWYgKHByb3BzLmlkICYmIHBheWxvYWQucm9sZS5pZCkgcm9sZS5pZCA9IGJvdC50cmFuc2Zvcm1lcnMuc25vd2ZsYWtlKHBheWxvYWQucm9sZS5pZClcbiAgaWYgKHByb3BzLm5hbWUgJiYgcGF5bG9hZC5yb2xlLm5hbWUpIHJvbGUubmFtZSA9IHBheWxvYWQucm9sZS5uYW1lXG4gIGlmIChwcm9wcy5wb3NpdGlvbikgcm9sZS5wb3NpdGlvbiA9IHBheWxvYWQucm9sZS5wb3NpdGlvblxuICBpZiAocHJvcHMuZ3VpbGRJZCAmJiBwYXlsb2FkLmd1aWxkSWQpIHJvbGUuZ3VpbGRJZCA9IGJvdC50cmFuc2Zvcm1lcnMuc25vd2ZsYWtlKHBheWxvYWQuZ3VpbGRJZClcbiAgaWYgKHByb3BzLmNvbG9yICYmIHBheWxvYWQucm9sZS5jb2xvciAhPT0gdW5kZWZpbmVkKSByb2xlLmNvbG9yID0gcGF5bG9hZC5yb2xlLmNvbG9yXG4gIGlmIChwcm9wcy5wZXJtaXNzaW9ucyAmJiBwYXlsb2FkLnJvbGUucGVybWlzc2lvbnMpIHJvbGUucGVybWlzc2lvbnMgPSBuZXcgUGVybWlzc2lvbnMocGF5bG9hZC5yb2xlLnBlcm1pc3Npb25zKVxuICBpZiAocHJvcHMuaWNvbiAmJiBwYXlsb2FkLnJvbGUuaWNvbikgcm9sZS5pY29uID0gaWNvbkhhc2hUb0JpZ0ludChwYXlsb2FkLnJvbGUuaWNvbilcbiAgaWYgKHByb3BzLnVuaWNvZGVFbW9qaSAmJiBwYXlsb2FkLnJvbGUudW5pY29kZV9lbW9qaSkgcm9sZS51bmljb2RlRW1vamkgPSBwYXlsb2FkLnJvbGUudW5pY29kZV9lbW9qaVxuICBpZiAocHJvcHMuZmxhZ3MpIHJvbGUuZmxhZ3MgPSBwYXlsb2FkLnJvbGUuZmxhZ3NcbiAgaWYgKHByb3BzLnRhZ3MgJiYgcGF5bG9hZC5yb2xlLnRhZ3MpIHtcbiAgICByb2xlLmludGVybmFsVGFncyA9IHt9XG4gICAgaWYgKHBheWxvYWQucm9sZS50YWdzLmJvdF9pZCkgcm9sZS5pbnRlcm5hbFRhZ3MuYm90SWQgPSBib3QudHJhbnNmb3JtZXJzLnNub3dmbGFrZShwYXlsb2FkLnJvbGUudGFncy5ib3RfaWQpXG4gICAgaWYgKHBheWxvYWQucm9sZS50YWdzLmludGVncmF0aW9uX2lkKSByb2xlLmludGVybmFsVGFncy5pbnRlZ3JhdGlvbklkID0gYm90LnRyYW5zZm9ybWVycy5zbm93Zmxha2UocGF5bG9hZC5yb2xlLnRhZ3MuaW50ZWdyYXRpb25faWQpXG4gICAgaWYgKHBheWxvYWQucm9sZS50YWdzLnN1YnNjcmlwdGlvbl9saXN0aW5nX2lkKVxuICAgICAgcm9sZS5pbnRlcm5hbFRhZ3Muc3Vic2NyaXB0aW9uTGlzdGluZ0lkID0gYm90LnRyYW5zZm9ybWVycy5zbm93Zmxha2UocGF5bG9hZC5yb2xlLnRhZ3Muc3Vic2NyaXB0aW9uX2xpc3RpbmdfaWQpXG4gIH1cbiAgaWYgKHByb3BzLnRvZ2dsZXMpIHtcbiAgICByb2xlLnRvZ2dsZXMgPSBuZXcgUm9sZVRvZ2dsZXMocGF5bG9hZC5yb2xlKVxuICB9XG5cbiAgcmV0dXJuIGJvdC50cmFuc2Zvcm1lcnMuY3VzdG9taXplcnMucm9sZShib3QsIHBheWxvYWQucm9sZSwgcm9sZSlcbn1cbiJdLCJuYW1lcyI6WyJpY29uSGFzaFRvQmlnSW50IiwiUGVybWlzc2lvbnMiLCJSb2xlVG9nZ2xlcyIsImJhc2VSb2xlIiwidW5kZWZpbmVkIiwidGFncyIsImJvdElkIiwiaW50ZXJuYWxUYWdzIiwiaW50ZWdyYXRpb25JZCIsInN1YnNjcmlwdGlvbkxpc3RpbmdJZCIsImF2YWlsYWJsZUZvclB1cmNoYXNlIiwidG9nZ2xlcyIsImd1aWxkQ29ubmVjdGlvbnMiLCJwcmVtaXVtU3Vic2NyaWJlciIsImhvaXN0IiwiaGFzIiwibWFuYWdlZCIsIm1lbnRpb25hYmxlIiwidHJhbnNmb3JtUm9sZSIsImJvdCIsInBheWxvYWQiLCJyb2xlIiwiT2JqZWN0IiwiY3JlYXRlIiwicHJvcHMiLCJ0cmFuc2Zvcm1lcnMiLCJkZXNpcmVkUHJvcGVydGllcyIsImlkIiwic25vd2ZsYWtlIiwibmFtZSIsInBvc2l0aW9uIiwiZ3VpbGRJZCIsImNvbG9yIiwicGVybWlzc2lvbnMiLCJpY29uIiwidW5pY29kZUVtb2ppIiwidW5pY29kZV9lbW9qaSIsImZsYWdzIiwiYm90X2lkIiwiaW50ZWdyYXRpb25faWQiLCJzdWJzY3JpcHRpb25fbGlzdGluZ19pZCIsImN1c3RvbWl6ZXJzIl0sIm1hcHBpbmdzIjoiQUFDQSxTQUFzQ0EsZ0JBQWdCLFFBQVEsY0FBYTtBQUMzRSxTQUFTQyxXQUFXLFFBQVEsMkJBQTBCO0FBQ3RELFNBQVNDLFdBQVcsUUFBUSxvQkFBbUI7QUFFL0MsT0FBTyxNQUFNQyxXQUFrRTtJQUM3RSwyRUFBMkU7SUFDM0UsR0FBSUMsU0FBUztJQUViLElBQUlDLFFBQU87UUFDVCxPQUFPO1lBQ0xDLE9BQU8sSUFBSSxDQUFDQyxZQUFZLEVBQUVEO1lBQzFCRSxlQUFlLElBQUksQ0FBQ0QsWUFBWSxFQUFFQztZQUNsQ0MsdUJBQXVCLElBQUksQ0FBQ0YsWUFBWSxFQUFFRTtZQUMxQ0Msc0JBQXNCLElBQUksQ0FBQ0MsT0FBTyxFQUFFRDtZQUNwQ0Usa0JBQWtCLElBQUksQ0FBQ0QsT0FBTyxFQUFFQztZQUNoQ0MsbUJBQW1CLElBQUksQ0FBQ0YsT0FBTyxFQUFFRTtRQUNuQztJQUNGO0lBQ0EsMERBQTBELEdBQzFELElBQUlDLFNBQVE7UUFDVixPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUNILE9BQU8sRUFBRUksSUFBSTtJQUM3QjtJQUNBLG1EQUFtRCxHQUNuRCxJQUFJQyxX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