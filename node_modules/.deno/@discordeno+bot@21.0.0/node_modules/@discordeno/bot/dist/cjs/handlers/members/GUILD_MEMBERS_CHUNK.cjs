"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "handleGuildMembersChunk", {
    enumerable: true,
    get: function() {
        return handleGuildMembersChunk;
    }
});
const _utils = require("@discordeno/utils");
async function handleGuildMembersChunk(bot, data) {
    const payload = data.d;
    // If it's not enabled skip checks.
    if (!bot.gateway.cache.requestMembers.enabled) return;
    // If this request has no nonce, skip checks.
    if (!payload.nonce) return;
    const pending = bot.gateway.cache.requestMembers.pending.get(payload.nonce);
    if (!pending) return;
    if (payload.chunk_count === 1) pending.members = payload.members;
    else pending.members.push(...payload.members);
    // If this is not the final chunk, just save to cache.
    if (payload.chunk_index + 1 < payload.chunk_count) return;
    // Resolve the promise that all requests are done.
    pending.resolve((0, _utils.camelize)(pending.members));
    // Delete the cache to clean up once its done.
    bot.gateway.cache.requestMembers.pending.delete(payload.nonce);
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9oYW5kbGVycy9tZW1iZXJzL0dVSUxEX01FTUJFUlNfQ0hVTksudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBEaXNjb3JkR2F0ZXdheVBheWxvYWQsIERpc2NvcmRHdWlsZE1lbWJlcnNDaHVuayB9IGZyb20gJ0BkaXNjb3JkZW5vL3R5cGVzJ1xuaW1wb3J0IHsgY2FtZWxpemUgfSBmcm9tICdAZGlzY29yZGVuby91dGlscydcbmltcG9ydCB0eXBlIHsgQm90IH0gZnJvbSAnLi4vLi4vaW5kZXguanMnXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYW5kbGVHdWlsZE1lbWJlcnNDaHVuayhib3Q6IEJvdCwgZGF0YTogRGlzY29yZEdhdGV3YXlQYXlsb2FkKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IHBheWxvYWQgPSBkYXRhLmQgYXMgRGlzY29yZEd1aWxkTWVtYmVyc0NodW5rXG5cbiAgLy8gSWYgaXQncyBub3QgZW5hYmxlZCBza2lwIGNoZWNrcy5cbiAgaWYgKCFib3QuZ2F0ZXdheS5jYWNoZS5yZXF1ZXN0TWVtYmVycy5lbmFibGVkKSByZXR1cm5cblxuICAvLyBJZiB0aGlzIHJlcXVlc3QgaGFzIG5vIG5vbmNlLCBza2lwIGNoZWNrcy5cbiAgaWYgKCFwYXlsb2FkLm5vbmNlKSByZXR1cm5cblxuICBjb25zdCBwZW5kaW5nID0gYm90LmdhdGV3YXkuY2FjaGUucmVxdWVzdE1lbWJlcnMucGVuZGluZy5nZXQocGF5bG9hZC5ub25jZSlcblxuICBpZiAoIXBlbmRpbmcpIHJldHVyblxuXG4gIGlmIChwYXlsb2FkLmNodW5rX2NvdW50ID09PSAxKSBwZW5kaW5nLm1lbWJlcnMgPSBwYXlsb2FkLm1lbWJlcnNcbiAgZWxzZSBwZW5kaW5nLm1lbWJlcnMucHVzaCguLi5wYXlsb2FkLm1lbWJlcnMpXG5cbiAgLy8gSWYgdGhpcyBpcyBub3QgdGhlIGZpbmFsIGNodW5rLCBqdXN0IHNhdmUgdG8gY2FjaGUuXG4gIGlmIChwYXlsb2FkLmNodW5rX2luZGV4ICsgMSA8IHBheWxvYWQuY2h1bmtfY291bnQpIHJldHVyblxuXG4gIC8vIFJlc29sdmUgdGhlIHByb21pc2UgdGhhdCBhbGwgcmVxdWVzdHMgYXJlIGRvbmUuXG4gIHBlbmRpbmcucmVzb2x2ZShjYW1lbGl6ZShwZW5kaW5nLm1lbWJlcnMpKVxuXG4gIC8vIERlbGV0ZSB0aGUgY2FjaGUgdG8gY2xlYW4gdXAgb25jZSBpdHMgZG9uZS5cbiAgYm90LmdhdGV3YXkuY2FjaGUucmVxdWVzdE1lbWJlcnMucGVuZGluZy5kZWxldGUocGF5bG9hZC5ub25jZSlcbn1cbiJdLCJuYW1lcyI6WyJoYW5kbGVHdWlsZE1lbWJlcnNDaHVuayIsImJvdCIsImRhdGEiLCJwYXlsb2FkIiwiZCIsImdhdGV3YXkiLCJjYWNoZSIsInJlcXVlc3RNZW1iZXJzIiwiZW5hYmxlZCIsIm5vbmNlIiwicGVuZGluZyIsImdldCIsImNodW5rX2NvdW50IiwibWVtYmVycyIsInB1c2giLCJjaHVua19pbmRleCIsInJlc29sdmUiLCJjYW1lbGl6ZSIsImRlbGV0ZSJdLCJtYXBwaW5ncyI6Ijs7OzsrQkFJc0JBOzs7ZUFBQUE7Ozt1QkFIRztBQUdsQixlQUFlQSx3QkFBd0JDLEdBQVEsRUFBRUMsSUFBMkI7SUFDakYsTUFBTUMsVUFBVUQsS0FBS0UsQ0FBQztJQUV0QixtQ0FBbUM7SUFDbkMsSUFBSSxDQUFDSCxJQUFJSSxPQUFPLENBQUNDLEtBQUssQ0FBQ0MsY0FBYyxDQUFDQyxPQUFPLEVBQUU7SUFFL0MsNkNBQTZDO0lBQzdDLElBQUksQ0FBQ0wsUUFBUU0sS0FBSyxFQUFFO0lBRXBCLE1BQU1DLFVBQVVULElBQUlJLE9BQU8sQ0FBQ0MsS0FBSyxDQUFDQyxjQUFjLENBQUNHLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDUixRQUFRTSxLQUFLO0lBRTFFLElBQUksQ0FBQ0MsU0FBUztJQUVkLElBQUlQLFFBQVFTLFdBQVcsS0FBSyxHQUFHRixRQUFRRyxPQUFPLEdBQUdWLFFBQVFVLE9BQU87U0FDM0RILFFBQVFHLE9BQU8sQ0FBQ0MsSUFBSSxJQUFJWCxRQUFRVSxPQUFPO0lBRTVDLHNEQUFzRDtJQUN0RCxJQUFJVixRQUFRWSxXQUFXLEdBQUcsSUFBSVosUUFBUVMsV0FBVyxFQUFFO0lBRW5ELGtEQUFrRDtJQUNsREYsUUFBUU0sT0FBTyxDQUFDQyxJQUFBQSxlQUFRLEVBQUNQLFFBQVFHLE9BQU87SUFFeEMsOENBQThDO0lBQzlDWixJQUFJSSxPQUFPLENBQUNDLEtBQUssQ0FBQ0MsY0FBYyxDQUFDRyxPQUFPLENBQUNRLE1BQU0sQ0FBQ2YsUUFBUU0sS0FBSztBQUMvRCJ9